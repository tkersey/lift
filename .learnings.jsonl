{"id": "lrn-20260220T132548Z-f18cdc57", "captured_at": "2026-02-20T13:25:48Z", "status": "do_more", "learning": "When Zig CLI output can be piped, catch terminal WriteFailed/BrokenPipe at stdout/stderr boundaries to avoid noisy unhandled runtime errors.", "evidence": ["zig run scripts/bench_stats.zig -- <<'EOF' | head -n 1 ... now outputs only first line without error", "zig run scripts/bench_stats.zig -- <<'EOF' 1>&- ... exits without error text after guard"], "application": "Wrap user-facing terminal writes with a small ignoreTerminalWriteError helper while keeping non-terminal file writes as hard failures.", "context": {"repo": "tkersey/lift", "branch": "main", "paths": ["scripts/bench_stats.zig", "scripts/perf_report.zig"]}, "source": "skill:learnings", "fingerprint": "f18cdc571e132646", "tags": ["zig", "cli", "io", "broken_pipe"]}
{"id": "lrn-20260220T133015Z-2abeb289", "captured_at": "2026-02-20T13:30:15Z", "status": "do_more", "learning": "For Zig CLIs, handle broken pipes by writing via std.fs.File.writeAll and catching error.BrokenPipe; avoid fd-type probing on stdio handles because closed descriptors can panic in stat paths.", "evidence": ["zig run scripts/bench_stats.zig -- <<'EOF' | head -n 1 ... outputs first line with no WriteFailed", "closed-fd check now returns NotOpenForWriting (no panic), preserving non-broken-pipe failures"], "application": "Use a small writeToStreamAllowBrokenPipe helper for stdout/stderr user-facing output; keep other write errors surfaced.", "context": {"repo": "tkersey/lift", "branch": "main", "paths": ["scripts/bench_stats.zig", "scripts/perf_report.zig"]}, "source": "skill:learnings", "fingerprint": "2abeb2894b5fc1ec", "tags": ["zig", "cli", "io", "broken_pipe", "safety"], "supersedes_id": "lrn-20260220T132548Z-f18cdc57"}
